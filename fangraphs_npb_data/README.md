# Extract FanGraphs NPB Data

## 概要
- FanGraphsにあるNPBデータを抽出するためのものです。
- 本フォルダには以下2つのファイルがあります。
    - fg_npb_leaderboard.ipynb : リーダーボードから打撃成績データを取得（全選手対象）
    - fg_npb_player_detail.ipynb : リーダーボードから投手成績データを取得（全選手対象）

## 処理内容
それぞれのファイルで実施している処理内容を説明します。
### 1. fg_npb_leaderboard.ipynb
- リーダーボードから開始年度・終了年度・成績区分を指定し、データを取得します。
#### 1-1. 取得方法
- 取得方法は単年度（single season）・複数年度（multiple seasons）の2通りがあります。
    - 単年度（single season）
        - 各年度の単年度のデータを連続して取得します。
        - 例えば開始年度：2024年、終了年度：2025年を指定した場合、2024年のデータおよび2025年のデータをそれぞれ取得し、ひとつにまとめています。
    - 複数年度（single season）
        - 開始年度・終了年度を指定し、その期間を通じたのデータを連続して取得します。
        - 例えば開始年度：2024年、終了年度：2025年を指定した場合、2024年から2025年までの合算データを取得しています。
#### 1-2. 指定内容
- それぞれの関数では、以下3点の引数を指定する必要があります。
    - start_year : 開始年度（4桁の数字で指定）
    - end_year : 終了年度（4桁の数字で指定）
    - stats_type : 成績区分（"bat"（打撃成績）あるいは"pit"（投手成績）のいずれかを指定）
> [!NOTE]  
> - 抽出対象データのうち、"Name"はタグの内容がそのまま取得されてしまうこと、また他のフィールドで代替可能なことから削除しています。

### 2. fg_npb_player_detail.ipynb
- 各選手の詳細ページから打撃/投手成績および、守備成績のデータを取得します。
    - 野手の場合は打撃成績・守備成績、投手の場合は投手成績・守備成績を取得できます。

#### 2-1. 取得方法
- 取得対象はメイン成績（野手の場合は打撃成績、投手の場合は投手成績）・守備成績です。
    - メイン成績（打撃成績あるいは投手成績）
        - 各年度の打撃成績あるいは投手成績を取得します。
        - 野手を指定した場合は打撃成績が、投手を指定した場合は投手成績が自動で選択されます。
    - 守備成績
        - 各年度の守備成績を取得します。野手・投手共通です。
#### 2-2. 指定内容
- それぞれの関数では、以下3点の引数を指定する必要があります。
    - first_name : ファーストネーム（日本人の場合は名、小文字で指定）
    - last_name : ラストネーム（日本人の場合は姓、小文字で指定）
    - playerid : FanGraphsが定義している選手ID
        - 選手IDは画面から確認可能。なお、リーダーボードから抽出されたデータにも格納されています。
> [!NOTE]  
> - 抽出対象データのうち、"Season"および"Team"はタグの内容がそのまま取得されてしまうこと、また他のフィールドで代替可能なことから削除しています。
> - MLB経験のある選手の場合、FanGraphsのID（5桁）が振られています。左記選手を対象とする場合、そちらのIDを指定してください。
>   - なお、上記の場合NPB・MLBのデータが同一のデータフレームに格納されます。このため、NPBしか経験のない選手に比べてフィールド数が非常に多くなります。
>   - 同様の方法で、MLBの選手データも取得することができます。

## 利用言語・環境等
- 言語はPythonで記述しています。
- ファイルはJupyter Notebook形式（.ipynb）にて保存しています。
- FanGraphsのNPBデータは2019年から存在しています。

## 使い方
- Google Colab等、Jupyter Notebookをご利用可能であれば、順次コードを実行するだけで結果を得ることができます（検証済）。
- .pyファイルとして実行される際は、必要に応じて修正の上ご利用ください。